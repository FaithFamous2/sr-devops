# =============================================================================
# Docker Compose Override â€” Local Development
# Adds bind mounts, debug settings, and exposed ports for local development.
# Applied automatically when running `docker compose up`.
# =============================================================================

services:
  api:
    build:
      target: production
    environment:
      - APP_ENV=local
      - APP_DEBUG=true
      - LOG_CHANNEL=stderr
    volumes:
      # Bind mount source code for live changes (override named volumes)
      - ./backend:/var/www/html
      - /var/www/html/vendor  # Prevent overwriting vendor
    ports:
      - "8080:8080"   # Direct access (bypass Traefik for debugging)

  frontend:
    build:
      args:
        VITE_API_URL: http://secure-drop.localhost/api/v1
        VITE_UI_URL: http://secure-drop-ui.localhost
    ports:
      - "3000:8080"   # Direct access (bypass Traefik for debugging)
